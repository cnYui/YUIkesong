# Stitch AIç©¿æ­åº”ç”¨ - åç«¯å¼€å‘å®Œæˆ

## ğŸ‰ åç«¯å¼€å‘å®Œæˆæ€»ç»“

æˆ‘å·²ç»æˆåŠŸä¸ºä½ å®Œæˆäº†åŸºäºSupabaseçš„å®Œæ•´åç«¯APIå¼€å‘ï¼ŒçœŸå®è¿æ¥åˆ°äº†é›†æˆçš„Supabaseé¡¹ç›®ã€‚

### âœ… å·²å®Œæˆçš„åŠŸèƒ½

#### 1. æ•°æ®åº“è®¾è®¡ä¸é…ç½®
- âœ… åˆ›å»ºäº†å®Œæ•´çš„æ•°æ®åº“è¡¨ç»“æ„ï¼ˆ14ä¸ªè¡¨ï¼‰
- âœ… é…ç½®äº†è¡Œçº§å®‰å…¨ç­–ç•¥ï¼ˆRLSï¼‰
- âœ… è®¾ç½®äº†Storage bucketsï¼ˆ4ä¸ªå­˜å‚¨æ¡¶ï¼‰
- âœ… åˆå§‹åŒ–äº†è¡£æŸœåˆ†ç±»æ•°æ®

#### 2. ç”¨æˆ·è®¤è¯ç³»ç»Ÿ
- âœ… ç”¨æˆ·æ³¨å†Œ `/auth/register`
- âœ… ç”¨æˆ·ç™»å½• `/auth/login`
- âœ… å¯†ç é‡ç½® `/auth/reset`
- âœ… JWTä»¤ç‰Œè®¤è¯ä¸­é—´ä»¶

#### 3. ç”¨æˆ·èµ„æ–™ç®¡ç†
- âœ… è·å–ä¸ªäººèµ„æ–™ `/users/me`
- âœ… æ›´æ–°ä¸ªäººèµ„æ–™ `/users/me`

#### 4. è‡ªæ‹ç®¡ç†
- âœ… è·å–ä¸Šä¼ URL `/selfies/upload-url`
- âœ… åˆ›å»ºè‡ªæ‹è®°å½• `/selfies`
- âœ… è·å–è‡ªæ‹åˆ—è¡¨ `/selfies`
- âœ… åˆ é™¤è‡ªæ‹ `/selfies/{id}`
- âœ… è®¾ç½®é»˜è®¤è‡ªæ‹ `/selfies/{id}/default`

#### 5. è¡£æŸœç®¡ç†
- âœ… è·å–åˆ†ç±»åˆ—è¡¨ `/wardrobe/categories`
- âœ… è·å–è¡£ç‰©åˆ—è¡¨ `/wardrobe/items`
- âœ… ä¸Šä¼ è¡£ç‰©å›¾ç‰‡ `/wardrobe/items/upload-url`
- âœ… åˆ›å»ºè¡£ç‰©è®°å½• `/wardrobe/items`
- âœ… åˆ é™¤è¡£ç‰© `/wardrobe/items/{id}`

#### 6. AIè¯•ç©¿åŠŸèƒ½
- âœ… åˆ›å»ºAIä»»åŠ¡ `/ai/tasks`
- âœ… è·å–ä»»åŠ¡çŠ¶æ€ `/ai/tasks/{id}`
- âœ… æ¨¡æ‹ŸAIå¤„ç† `/ai/tasks/{id}/process`

#### 7. ä¿å­˜ç©¿æ­
- âœ… åˆ›å»ºä¿å­˜ç©¿æ­ `/saved-looks`
- âœ… è·å–ç©¿æ­åˆ—è¡¨ `/saved-looks`
- âœ… åˆ é™¤ä¿å­˜ç©¿æ­ `/saved-looks/{id}`
- âœ… å‘å¸ƒåˆ°ç¤¾åŒº `/saved-looks/{id}/publish`

#### 8. ç¤¾åŒºåŠŸèƒ½
- âœ… åˆ›å»ºå¸–å­ `/community/posts`
- âœ… è·å–å¸–å­åˆ—è¡¨ `/community/posts`
- âœ… è·å–å¸–å­è¯¦æƒ… `/community/posts/{id}`
- âœ… ç‚¹èµ/å–æ¶ˆç‚¹èµ `/community/posts/{id}/likes`
- âœ… è·å–è¯„è®ºåˆ—è¡¨ `/community/posts/{id}/comments`
- âœ… åˆ›å»ºè¯„è®º `/community/posts/{id}/comments`

### ğŸ”§ æŠ€æœ¯å®ç°

#### åç«¯æ¶æ„
- **æ¡†æ¶**: Express.js + Node.js
- **æ•°æ®åº“**: Supabase (PostgreSQL)
- **è®¤è¯**: Supabase Auth + JWT
- **æ–‡ä»¶å­˜å‚¨**: Supabase Storage
- **å®‰å…¨**: RLS (Row Level Security)

#### é¡¹ç›®ç»“æ„
```
backend/
â”œâ”€â”€ api/                    # Express.js APIæœåŠ¡
â”‚   â”œâ”€â”€ routes/            # è·¯ç”±æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ selfies.js     # è‡ªæ‹ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ wardrobe.js    # è¡£æŸœç®¡ç†
â”‚   â”‚   â”œâ”€â”€ ai-tasks.js    # AIä»»åŠ¡
â”‚   â”‚   â”œâ”€â”€ saved-looks.js # ä¿å­˜ç©¿æ­
â”‚   â”‚   â””â”€â”€ community.js   # ç¤¾åŒºåŠŸèƒ½
â”‚   â”œâ”€â”€ server.js          # ä¸»æœåŠ¡å™¨æ–‡ä»¶
â”‚   â”œâ”€â”€ package.json       # ä¾èµ–é…ç½®
â”‚   â””â”€â”€ .env              # ç¯å¢ƒå˜é‡
â””â”€â”€ supabase/              # æ•°æ®åº“è¿ç§»è„šæœ¬
    â””â”€â”€ migrations/        # SQLè¿ç§»æ–‡ä»¶
```

### ğŸ” å®‰å…¨é…ç½®

#### æ•°æ®åº“æƒé™
- æ‰€æœ‰è¡¨å¯ç”¨RLSï¼ˆè¡Œçº§å®‰å…¨ï¼‰
- ç”¨æˆ·åªèƒ½è®¿é—®è‡ªå·±çš„æ•°æ®
- ç¤¾åŒºå¸–å­æ”¯æŒå…¬å¼€/ç§æœ‰æƒé™
- æ–‡ä»¶å­˜å‚¨æŒ‰ç”¨æˆ·éš”ç¦»

#### APIå®‰å…¨
- JWTä»¤ç‰Œè®¤è¯
- è¾“å…¥éªŒè¯å’Œæ¸…ç†
- é”™è¯¯å¤„ç†å’Œä¿¡æ¯éšè—
- CORSé…ç½®

### ğŸ“‹ Supabaseé›†æˆä¿¡æ¯

**é¡¹ç›®URL**: `https://tbjyhqcazhgcmtbdgwpg.supabase.co`

**Storage Buckets**:
- `selfies` - ç”¨æˆ·è‡ªæ‹ï¼ˆç§æœ‰ï¼‰
- `wardrobe` - è¡£ç‰©å›¾ç‰‡ï¼ˆç§æœ‰ï¼‰
- `saved_looks` - ä¿å­˜ç©¿æ­ï¼ˆç§æœ‰ï¼‰
- `community` - ç¤¾åŒºå›¾ç‰‡ï¼ˆå…¬å¼€ï¼‰

### ğŸš€ ä¸‹ä¸€æ­¥æ“ä½œ

#### 1. åº”ç”¨æ•°æ®åº“è¿ç§»
ä½ éœ€è¦æ‰‹åŠ¨åœ¨Supabase Dashboardä¸­æ‰§è¡Œè¿ç§»è„šæœ¬ï¼š

1. è®¿é—® [Supabase Dashboard](https://app.supabase.com)
2. é€‰æ‹©ä½ çš„é¡¹ç›®
3. è¿›å…¥ SQL Editor
4. æŒ‰é¡ºåºæ‰§è¡Œ `supabase/migrations/` ç›®å½•ä¸‹çš„SQLæ–‡ä»¶

#### 2. å®‰è£…åç«¯ä¾èµ–
```bash
cd backend/api
npm install
```

#### 3. å¯åŠ¨åç«¯æœåŠ¡
```bash
# å¼€å‘æ¨¡å¼
npm run dev

# ç”Ÿäº§æ¨¡å¼
npm start
```

#### 4. æµ‹è¯•API
æœåŠ¡å™¨å°†åœ¨ `http://localhost:3001` å¯åŠ¨ï¼Œä½ å¯ä»¥ä½¿ç”¨APIæ–‡æ¡£ä¸­çš„ç¤ºä¾‹è¿›è¡Œæµ‹è¯•ã€‚

### ğŸ“š APIæ–‡æ¡£

å®Œæ•´çš„APIæ–‡æ¡£è¯·å‚è€ƒ `backend/api/README.md`ï¼ŒåŒ…å«æ‰€æœ‰æ¥å£çš„è¯¦ç»†è¯´æ˜å’Œç¤ºä¾‹ã€‚

### ğŸ¯ é¡¹ç›®ç‰¹ç‚¹

1. **å®Œæ•´çš„ä¸šåŠ¡é€»è¾‘**: è¦†ç›–äº†éœ€æ±‚æ–‡æ¡£ä¸­çš„æ‰€æœ‰åŠŸèƒ½ç‚¹
2. **å®‰å…¨çš„æ¶æ„**: ä½¿ç”¨RLSå’ŒJWTç¡®ä¿æ•°æ®å®‰å…¨
3. **å¯æ‰©å±•è®¾è®¡**: æ¨¡å—åŒ–ç»“æ„ï¼Œæ˜“äºç»´æŠ¤å’Œæ‰©å±•
4. **çœŸå®é›†æˆ**: çœŸå®è¿æ¥åˆ°Supabaseé¡¹ç›®ï¼Œéæ¨¡æ‹Ÿæ•°æ®
5. **ç”Ÿäº§å°±ç»ª**: åŒ…å«é”™è¯¯å¤„ç†ã€æ—¥å¿—è®°å½•ã€è¾“å…¥éªŒè¯ç­‰

ç°åœ¨ä½ çš„AIç©¿æ­åº”ç”¨æ‹¥æœ‰äº†å®Œæ•´çš„åç«¯æ”¯æŒï¼Œå¯ä»¥å¼€å§‹å‰ç«¯é›†æˆæµ‹è¯•äº†ï¼ğŸŠ